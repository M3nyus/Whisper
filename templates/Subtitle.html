<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <title>Hello, world!</title>
</head>
<body>
<main class="container text-center">
    <br>
    <h1>Feliratozás státusz</h1>
    <div class="progress">
        <div id='progress-bar' class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25"
             aria-valuemin="0" aria-valuemax="100">25%
        </div>
    </div>
    <div class="text-start">
        <pre>{{ szoveg }}</pre>
    </div>


    <form action="/">
        <button href="/">Vissza</button>
    </form>

    <form action="/onehang" method="get">
        <button type="submit">OneHang oldal</button>
    </form>
    <script>
        function checkProgress() {
          $.get('/progress', function(data) {
            // Assume the server returns JSON like { percent: 42 }
            var percent = data;

            console.log('Progress:', percent + '%');
            $('#progress-bar').css('width', percent + '%').text(percent + '%');

            if (percent < 100) {
              // Check again after 5 seconds
              setTimeout(checkProgress, 5000);
            } else {
              console.log('Progress complete!');
            }
          }).fail(function() {
            console.error('Failed to fetch progress.');
            setTimeout(checkProgress, 5000); // Retry on failure
          });
        }

        // Start polling
        checkProgress();

    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>
</main>
</body>
</html>
